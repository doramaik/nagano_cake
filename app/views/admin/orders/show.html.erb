<div class='container'>
    <h2>注文履歴詳細</h2>
<div class="row-12">


<dt>購入者</dt>
<dd>
<%= @order.customer.last_name %><%= @order.customer.first_name %>
</dd>
<dt>注文日</dt>
<dd><%= @order.created_at %></dd>
<dt>配送先</dt>
<dd>
<p><%= @order.postal_code %> <%= @order.shipping_address %></p>
<p><%= @order.shipping_name %></p>
</dd>
<dt>支払方法</dt>
<dd> <%= @order.payment_method_i18n %></dd>
<dt>注文ステータス</dt>
<dd>
<%= form_with model: @order, url: admin_order_path(@order), method: :patch, local: true do |f| %>
<%= f.select :order_status, Order.order_statuses.keys.map {|k| [I18n.t("enums.order.order_status.#{k}"), k]} %>
<%= f.hidden_field :id, :value => @order.id %>
<%= f.submit"更新", class: "btn btn-success" %>
<% end %>
</dd>


<table class="table">
<thead class="table-light">
<tr>
<th>商品名</th>
<th>単価（税込）</th>
<th>数量</th>
<th>小計</th>
<th>製作ステータス</th>
</tr>
</thead>
<tbody>
<% @order_details.each do |order_detail| %>
<tr>
<td><%= order_detail.item.name %></td>
<td><%= order_detail.item.with_tax_price %></td>
<td><%= order_detail.price %></td>
<td><%= order_detail.price %></td>
<td>
<%= form_with model: order_detail, url: admin_order_detail_path(order_detail), method: :patch, local: true do |f| %>
<%= f.select :production_status, OrderDetail. production_statuses.keys.map {|k| [I18n.t("enums.order_detail.production_status.#{k}"), k]} %>
<%= f.hidden_field :id, :value => order_detail.id %>
<%= f.submit"更新", class: "btn btn-success" %>
<% end %>
</td>
</tr>
<% end %>
</tbody>
</table>

<div class="col-xs-8"style="margin-top: 120px;">
<dt class="col-sm-8">商品合計</dt>
<dd class="col-sm-12"><%= @sum %></dd>
<dt class="col-sm-8">送料</dt>
<dd class="col-sm-12"><%= @order.shipping_fee %></dd>
<dt class="col-sm-8">請求金額合計</dt>
<dd class="col-sm-12"><%= @sum + @order.shipping_fee %></dd>
</div>
</div>
</div>
